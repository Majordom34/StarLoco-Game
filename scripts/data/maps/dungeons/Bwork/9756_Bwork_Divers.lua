local map = MapDef(
        9756,
        "0706131721",
        "4b76774359697450766a55372c29386c3b6a64762532356d605053373c27303d57386c3d3e367e435c4775764343233460542532426373602126344c7753747725324271365960694b3e4d3a686c4d6d7a4f273e64307d684b6f792d447c58216c3f3145412428253242514b642532426c4f2a7561292037615c6776754071276257737e7148673c53616c7643714e5c526d6d625e3b36253235504f4e262a41522f7725324239757c282f7e315d3f7d7978306d3b753e76232c486a736131343247755366573d55785033596e6b5d465e52423a447173652270565c78782c3b4e6334675e70367234763f69382d53417d6d5f3c526f7d57752937213455423231493424736c5374",
        "bhaaeaaaaabhaaeaaaaabhaaeaaaaabhGaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaaHhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaaHhaaeaaaaaHhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaaHhaaeaaaaaHhaaeaaaaaHhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaaHhaaeaaaaaHhaaeaaaaaHhaaeaaaaaHhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaaHhaaeaaaaaHhaaeaaaaaGhaaeaaaB9HhaaeaaaaaGhaaeaaaB9bhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaaHhaaeaaaaaHhaaeaaaaaGhaaeaaaaaGhaaeaaaaaGhaaeaaaaaGhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaaHhaaeaaaaaHhaaeaaaaaGhaaeaaaB7GhbgeaaaCbGhbgepFaB8HhbgeaaaP7GhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaaHhaaeaaaaaGhbgeaaaaaGhaaeaaaB7HhHgeaaaaaHhHgeaaaaaHhHgeaaeaaHhbgeaaaaaGhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaaHhaaeaaaaaGhbgeaaaaaGhbgeaaaB7HhHgeaaaaaHhHgeaaaaaHhHgeaaaaaHhHgeaaaaaHhbgeaaaaaGhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaaHhaaeaaaaaGhaaeaaaaaGhbgeaaaaaHhHgeaaaaaHhHgeaaaaaHhHgeaaaaaHhHgeaaaaaHhHgeaaaaaHhbgeaaaaaGhaaeaaaB8bhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaaHhaaeaaaaaHhaaeaaaaaGhaaeaaaB7HhHgeaaaaaHhHgersGaaHhHgerrWaaHhHgeaaaaaHNHgeaaaaaHhHgeaaaaaGhbgeaaaB8GhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaaHhaaeaaaaaHhaaeaaaaaGhaaeaaaaaHhHgeaaaaaHhHgeaaaaaHhXgeruaaaHhXgersWaaH3XgeaaabNHxHgeaaaaaGhbgeaaaB8HhbgeaaaAWGhaaeaaaB6bhaaeaaaaabhaaeaaaaaHhaaeaaaaaHhaaeaaaaaGhaaeaaaB7HhHgeaaaaaHhHgeaaaaaHhXgersqaaGhbgeruaqiHxXgeaaaYTHxXgeaaaaaHhXgeaaaaaHhHgeaaaAYGhbgeaaaA0GhaaeaaaaabhaaeaaaaabhaaeaaaaaHhaaeaaaaaGhaaeaaaaaGhbgeaaaxOHhHgeaaabNHxXgeaaaaaHhXgerrqaaH3XgersaaaHNXgerrGaaHxXgeaaaaaHhXgeaaaaaHhHgeaaaaaHhHgeaaaaaGhaaeaaaB6bhaaeaaaaaHhaaeaaaaaGhaaeaaaB7HhHgeaaaAYHhHgeaaaaaHxXgeaaaaaHxXgeaaaaaHhXgeaaaaaH3XgeaaaaaHNXgerraaaHxXgeaaaaaHhHgecFaaaHhHgeaaaaaHhHgerzWaaHhaaeaaaaabhaaeaaaaaHhaaeaaaaaHhbgersWAWHhHgeaaaaaHhXgeaaaaaHhXgeaaaaaHNXgeaaaaaH3HgeaaaaaH3XgepFaaaH3XgeaaaaaHxXgeaaaaaHxHgeaaaaaHhHgerzGaaHhaaerzaaabhaaeaaaaaHhaaeaaaoJHhaaersqaaHhHgerrWaaHhHgeaaaaaGNbgeaaaqiHxXgeaaaaaHNHgeaaaaaHNHgeaaaaaHxXgeaaaaaHxXgeaaaaaHNXgeaaaaaHxHgerrGaaHhHgeruaaaHhaaersWaabhaaeaaaaaHhaaeaaaaaHhaaerzGaaHhHgeaaaaaHhXgeaaaaaHxXgeaaaaaHNHgeaaaaaHxHgeaaaaaHhHgeaaapAHxXgeaaaaaHhXgeaaaaaHxHgerrGaaHhHgerwaaaHhHgeruaaaHhaaeaaaaaGhaaeaaaAVHhaaerrGaaHhHgerraaaHhHgeSIaaaHhXgeaaaaaHhXgersGaaHhHgersWaaHNHgeaaaaaHhHgeaaaaaH3XgeaaaaaHhXgeaaaaaHhHgeruaaaHhHgeruaaaHhaaersaaabhaaeaaaaaHhaaeaaaaaHhHgerzaaaHhHgeaaaaaHhHgeaaaaaHhXgeaaaaaHNXgeruaaaH3XgersWaaHhHgeaaaaaHxXgeaaaaaGhbgeaaaqiHhHgerrqaaHhHgeruaaaHhaaerzaaaHhaaeaaaaaHhaaeaaaaaHhaaerrqaaHhHgersWaaHhHgeaaaaaHhXgepFaaaHhXgersqaaH3XgepFaaaH3XgeaaaaaHhXgeaaaaaHNXgeaaaaaHhXgeaaaaaHhHgervaaaHhHgeruaaaHhaaeaaaaaHhaaeaaaaaHhaaeaaaaaHhaaerrqaaHhHgersWaaHhHgeaaaaaHhXgeaaaaaHhXgervaaaHNXgersaaaHNXgeaaabNHhXgepFaaaHhXgecFaaaHhXgeaaaaaHhHgerwaaaGhaaersaaaHhaaeaaaoJHhaaeaaaaaHhaaeaaaaaHhaaersqaaHhHgersWaaHhXgeaaaaaHhXgeaaaaaHhXgerraaaHhXgeaaaaaHhXgeaaaaaHhXgeaaaaaHhXgeaaaaaHhXgepFaaaHhaaervGaaGhaaeaaaA3HhaaeaaaAVHhaaeaaaaaHhaaeaaaaaHhaaeaaaaaHhXgecFaaaHhHgeaaaaaHhXgeaaaaaHhXgeaaaaaGhbgeaaaqiHhXgeaaaaaHhXgeaaaaaHhXgeaaaaaHhXgervWaaGhaaersWaaHhaaeaaaaabhaaeaaaaaHhaaeaaaaaHhaaeaaaaaHhrgeqgaaaHhHgerzaaaHhHgeaaaaaHhHgeaaaaaHhXgeaaaaaHhXgeaaaaaHhXgeaaaaaHhXgeaaaaaHhXgeaaaaaHhHgersqaaHhaaeaaaaaHhaaeaaaaabhaaeaaaaaHhaaeaaaaaHhaaeaaaaaHhaaeaaaaaHhHgersWaaHhHgeaaaaaHhHgeaaaaaHhHgeaaaaaHhHgeaaaaaHhHgersGaaHhXgersWaaHhXgeaaaaaHhHgerzGaaHhaaeaaaaabhaaeaaaaabhaaeaaaaaHhaaeaaaaaHhaaeoJaaaHhaaersqaaGhbgersWaaHhHgeaaaaaHhHgeaaaaaHhHgeaaaaaHhHgerzWaaHhaaerzqaaHhHgersWaaHhrgeqgaaaHhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaaHhaaeaaaaaHhaaeaaaaaGhaaersqA1HhbgerzWAZHhaaerzqaaHhHgerzWaaHhaaerzqaaHhaaersaaaHhaaersqaaHhHgerzWaaHhaaersaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaaHhaaeaaaaaGhaaeaaaaaHhaaersqaaHhaaersaaaHhaaeaaaaaHhaaeaaaaaHhaaeaaaaaHhaaeaaaaaHhaaerrqaaHhaaerraaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaaHhaaeaaaaaGhaaeaaaaaHhaaeoJaaaHhaaeaaaaaHhaaeaaaaaHhaaeaaaaabhaaeaaaaaHhaaeaaaaaHhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaaHhaaeaaaaaHhaaeaaaaaHhaaeaaaaabhaaeaaaaaHhaaeaaaaabhaaeaaaaabhaaeaaaaaHhaaeaaaaabhaaeaaaaabhaaeaaaaabhaaeaaaaa",
        15,
        17,
        -5,
        10,
        284
)

map.positions = "eEeTfkfxfzfMgbgcgr|cxc3dbdfdqdReMe0"
map.capabilities = 46

local function tryEntering(_, _, p)
    local teleportCells = {
        295, 310, 325, 340, 341, 326, 311, 296, 281, 266, 252, 267, 282, 297,
        312, 327, 313, 298, 283, 268, 253, 239, 254, 269, 284, 299, 255, 309,
        324, 339, 270, 225, 224, 280, 355
    }

    local playerCell = p:cell()
    for _, cell in ipairs(teleportCells) do
        if playerCell == cell then
            p:teleport(9763, 268)
            return
        end
    end

end
map.onMovementEnd = {
    [418] = moveEndTeleport(9755, 178),
    [380] = moveEndTeleport(9753, 198),
    [356] = tryEntering,
    [295] = tryEntering,
    [310] = tryEntering,
    [325] = tryEntering,
    [340] = tryEntering,
    [341] = tryEntering,
    [326] = tryEntering,
    [311] = tryEntering,
    [296] = tryEntering,
    [281] = tryEntering,
    [266] = tryEntering,
    [252] = tryEntering,
    [267] = tryEntering,
    [282] = tryEntering,
    [297] = tryEntering,
    [312] = tryEntering,
    [327] = tryEntering,
    [313] = tryEntering,
    [298] = tryEntering,
    [283] = tryEntering,
    [268] = tryEntering,
    [253] = tryEntering,
    [239] = tryEntering,
    [254] = tryEntering,
    [269] = tryEntering,
    [284] = tryEntering,
    [299] = tryEntering,
    [255] = tryEntering,
    [309] = tryEntering,
    [324] = tryEntering,
    [339] = tryEntering,
    [270] = tryEntering,
    [225] = tryEntering,
    [224] = tryEntering,
    [280] = tryEntering,
    [355] = tryEntering
}

RegisterMapDef(map)
